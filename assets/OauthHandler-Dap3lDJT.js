import{c as d,j as e,L as g}from"../index.js";import{u as f,R as r}from"./react-router-ChLYyIsA.js";import"./react-CjZsb-BP.js";const j=()=>{const l=f(),[t,a]=r.useState(null),[u,s]=r.useState(!0),c=r.useRef(!1);return r.useEffect(()=>{if(c.current)return;c.current=!0;const i=new URLSearchParams(l.search),o=i.get("code"),h=i.get("state");if(!o){a({success:!1,error:"No OAuth code found. Please try again."}),s(!1);return}s(!0);const x=d("/oauth/google");fetch(d("/php_backend/google-oauth.php",{redirect_uri:x,"google-oauth-callback":o}),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:o,state:h})}).then(n=>n.json()).then(n=>{a(n),s(!1)}).catch(()=>{a({success:!1,error:"OAuth failed. Please try again."}),s(!1)})},[l]),e.jsx(e.Fragment,{children:e.jsx("div",{id:"oauth-handler",className:"min-h-screen flex items-center justify-center bg-gray-100 dark:bg-gray-900",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 p-8 rounded shadow-md w-full max-w-md text-center",children:u?e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-2xl font-bold mb-6 text-blue-600 dark:text-white",children:"Processing OAuth..."}),e.jsx("p",{className:"text-gray-700 dark:text-gray-200 mb-4",children:"Please wait while we log you in with Google."})]}):e.jsxs(e.Fragment,{children:[t?.success?e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-2xl font-bold mb-6 text-green-600 dark:text-green-400",children:"Login Successful!"}),e.jsxs("p",{className:"text-gray-700 dark:text-gray-200 mb-2",children:["Welcome",t.email?`, ${t.email}`:"","!"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-2xl font-bold mb-6 text-red-600 dark:text-red-400",children:"Login Failed"}),e.jsx("p",{className:"text-gray-700 dark:text-gray-200 mb-2",children:t?.error||"Unknown error."})]}),e.jsxs("div",{className:"flex flex-col gap-2 mt-4 sm:flex-row sm:justify-center sm:gap-4",children:[e.jsxs(g,{href:"/dashboard",className:`w-full sm:w-48 flex items-center justify-center px-4 py-2 rounded font-semibold shadow transition focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-opacity-50
                    ${t&&!t.success?"bg-gray-300 text-gray-500 cursor-not-allowed pointer-events-none dark:bg-gray-700 dark:text-gray-400":"bg-blue-600 text-white hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600"}
                  `,"aria-disabled":t&&!t.success,tabIndex:t&&!t.success?-1:0,children:["Go to Dashboard ",e.jsx("i",{className:"fal fa-arrow-right ml-1"})]}),e.jsxs(g,{href:"/login",className:"w-full sm:w-48 flex items-center justify-center px-4 py-2 rounded bg-gray-200 text-blue-700 font-semibold shadow hover:bg-gray-300 transition dark:bg-gray-700 dark:text-blue-300 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-opacity-50",children:[e.jsx("i",{className:"fal fa-arrow-left mr-1"})," Back to Login"]})]})]})})})})};export{j as default};
